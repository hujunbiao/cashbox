(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33e699b9"],{2477:function(e,t,s){s("a29f")},"28a5":function(e,t,s){"use strict";var i=s("aae3"),n=s("cb7c"),a=s("ebd6"),r=s("0390"),o=s("9def"),u=s("5f1b"),d=s("520a"),c=s("79e5"),l=Math.min,h=[].push,p="split",b="length",f="lastIndex",v=4294967295,g=!c((function(){RegExp(v,"y")}));s("214f")("split",2,(function(e,t,s,c){var m;return m="c"=="abbc"[p](/(b)*/)[1]||4!="test"[p](/(?:)/,-1)[b]||2!="ab"[p](/(?:ab)*/)[b]||4!="."[p](/(.?)(.?)/)[b]||"."[p](/()()/)[b]>1||""[p](/.?/)[b]?function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!i(e))return s.call(n,e,t);var a,r,o,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,p=void 0===t?v:t>>>0,g=new RegExp(e.source,c+"g");while(a=d.call(g,n)){if(r=g[f],r>l&&(u.push(n.slice(l,a.index)),a[b]>1&&a.index<n[b]&&h.apply(u,a.slice(1)),o=a[0][b],l=r,u[b]>=p))break;g[f]===a.index&&g[f]++}return l===n[b]?!o&&g.test("")||u.push(""):u.push(n.slice(l)),u[b]>p?u.slice(0,p):u}:"0"[p](void 0,0)[b]?function(e,t){return void 0===e&&0===t?[]:s.call(this,e,t)}:s,[function(s,i){var n=e(this),a=void 0==s?void 0:s[t];return void 0!==a?a.call(s,n,i):m.call(String(n),s,i)},function(e,t){var i=c(m,e,this,t,m!==s);if(i.done)return i.value;var d=n(e),h=String(this),p=a(d,RegExp),b=d.unicode,f=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(g?"y":"g"),_=new p(g?d:"^(?:"+d.source+")",f),S=void 0===t?v:t>>>0;if(0===S)return[];if(0===h.length)return null===u(_,h)?[h]:[];var A=0,w=0,C=[];while(w<h.length){_.lastIndex=g?w:0;var x,y=u(_,g?h:h.slice(w));if(null===y||(x=l(o(_.lastIndex+(g?0:w)),h.length))===A)w=r(h,w,b);else{if(C.push(h.slice(A,w)),C.length===S)return C;for(var k=1;k<=y.length-1;k++)if(C.push(y[k]),C.length===S)return C;w=A=x}}return C.push(h.slice(A)),C}]}))},7597:function(e,t,s){s("a29f"),s("e60f"),s("857f")},7689:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"business_page",style:{height:e.bodyHeight+"px"}},[s("div",{staticClass:"operation_title_group"},[s("span",{staticClass:"operation_tip"},[e._v(e._s(e.$t("business.stepOne")))])]),s("div",{staticClass:"operation_type_group"},[s("van-radio-group",{staticClass:"radio_group_cls",model:{value:e.radioAuthBtnValue,callback:function(t){e.radioAuthBtnValue=t},expression:"radioAuthBtnValue"}},[s("van-radio",{staticStyle:{float:"left","margin-left":"10%"},attrs:{name:e.AddBusiness}},[e._v(e._s(e.$t("addBusiness"))+"\n            ")]),s("van-radio",{staticStyle:{float:"right","margin-right":"10%"},attrs:{name:e.DeleteBusiness}},[e._v(e._s(e.$t("businessCancel"))+"\n            ")])],1)],1),s("div",{staticClass:"business_step2_group"},[s("span",{staticClass:"business_step2_title"},[e._v(e._s(e.$t("business.stepTwo")))])]),s("div",{staticClass:"business_step2_content"},[s("div",{staticClass:"input_add_name_group"},[s("van-cell-group",[s("van-field",{attrs:{label:e.$t("business.name"),maxlength:"12",clearable:"",disabled:e.isForbidChangeUsername,placeholder:e.$t("inputAddressName"),id:"input_add_name_group"},model:{value:e.inputName,callback:function(t){e.inputName=t},expression:"inputName"}})],1),s("van-cell-group",[s("van-field",{attrs:{label:e.$t("business.address"),clearable:"",disabled:e.isForbidChangeAddress,"right-icon":e.addressRightIcon,placeholder:e.$t("inputAddress"),id:"input_add_name_group"},on:{"click-right-icon":e.scanOrChooseAddress},model:{value:e.inputAddress,callback:function(t){e.inputAddress=t},expression:"inputAddress"}})],1)],1),s("div",{staticClass:"setting_time_group"},[s("van-cell-group",[s("van-field",{attrs:{label:e.$t("setTimes"),type:"number",disabled:e.isForbidChangeAuthCount,id:"setting_time_group"},model:{value:e.countTime,callback:function(t){e.countTime=t},expression:"countTime"}})],1)],1)]),s("div",{staticClass:"address_popup_group"},[s("van-popup",{staticClass:"popup_window_group",model:{value:e.isShowAddressPopup,callback:function(t){e.isShowAddressPopup=t},expression:"isShowAddressPopup"}},[s("van-picker",{staticClass:"addPicker",attrs:{"show-toolbar":"",columns:e.addressList,"default-index":e.addressList.length/2},on:{cancel:function(t){e.isShowAddressPopup=!1},confirm:e.confirmPickerAddress}})],1)],1),s("div",{staticClass:"business_step3_group"},[s("span",{staticClass:"business_step3_title"},[e._v(e._s(e.$t("business.stepThree")))])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showQr,expression:"showQr"}],staticClass:"qr_group"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showQr,expression:"showQr"}],staticClass:"business_step2_content"},[s("ScanSign",{attrs:{code:e.signText}})],1)]),s("div",{staticClass:"business_step4_group"},[s("div",{staticClass:"business_step4_title"},[s("span",{staticClass:"qr_code_title"},[e._v(e._s(e.$t("business.stepFour")))])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showScanQrBtn,expression:"showScanQrBtn"}],staticClass:"business_step4_content"},[s("van-button",{staticClass:"get_signed_btn",attrs:{plain:"",type:"info"},on:{click:e.scanToSignedQr}},[e._v("扫码签名授权")])],1),s("van-divider",{staticClass:"divider_line"}),s("van-divider",{staticClass:"divider_line"}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowNextStepBtn,expression:"isShowNextStepBtn"}],staticClass:"auth_btn_group"},[s("van-button",{staticClass:"business_confirm_btn",attrs:{plain:"",type:"info"},on:{click:e.clickNextStep}},[e._v("签名完成，下一步")])],1),s("van-overlay",{attrs:{show:e.isLoadingAccount}},[s("van-loading",{staticClass:"loading_component",attrs:{type:"spinner",vertical:""}},[e._v("签名二维码数据生成中...")])],1)],1)},n=[],a=(s("28a5"),s("6b54"),s("7f7f"),s("ac6a"),s("96cf"),s("3b8d")),r=s("d225"),o=s("b0b4"),u=s("308d"),d=s("6bb5"),c=s("4e2b"),l=s("9ab4"),h=s("60a3"),p=s("e27c"),b=s("9f14"),f=s("b650"),v=s("9ed2"),g=s("6e47"),m=s("543e"),_=s("87ab"),S=s("8402"),A=(s("2477"),s("7597"),s("0147"),s("c2d8"),s("eeb2"),s("e815"),s("b657"),s("ec9d")),w=s("5aff"),C=s("45bc"),x=s("8e17"),y=s("1f21");h["d"].use(p["a"]).use(b["a"]).use(f["a"]).use(v["a"]).use(f["a"]).use(g["a"]).use(m["a"]);var k=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.inputName="",e.inputAddress="",e.isLoadingAccount=!1,e.signText="empty data",e.showQr=!1,e.showScanQrBtn=!1,e.isShowNextStepBtn=!1,e.isForbidChangeUsername=!1,e.isForbidChangeAddress=!1,e.isForbidChangeAuthCount=!1,e.countTime=1e3,e.AddBusiness=A["b"].Auth,e.DeleteBusiness=A["b"].Cancel,e.radioAuthBtnValue=e.AddBusiness,e.bodyHeight=0,e.waitSignInfo="",e.businessModel=new A["c"],e.signedValue="",e.authAddress="",e.addressRightIcon=y["a"].ICON_ARROW_DOWN,e.isShowAddressPopup=!1,e.addressList=Array(),e.SeparateSymbol=";",e}return Object(c["a"])(t,e),Object(o["a"])(t,[{key:"created",value:function(){this.$store.state.title=this.$t("businessAuthorize"),window.nativeQrScanToJsResult=this.nativeQrScanToJsResult}},{key:"mounted",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.bodyHeight=93*document.documentElement.clientHeight/100,e.next=3,C["b"].getInstance().loadBusinessList(this.$store.state.nativeChainAddress);case 3:t=e.sent,t.forEach((function(e){s.addressList.push(e.name+s.SeparateSymbol+e.address)}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onChangeAuthType",value:function(e){e===this.AddBusiness?(this.businessModel.authType=A["b"].Auth,this.addressRightIcon=y["a"].ICON_SCAN):e===this.DeleteBusiness?(this.businessModel.authType=A["b"].Cancel,this.addressRightIcon=y["a"].ICON_ARROW_DOWN):(w["a"].show("操作类型选择有误，请重新检查后选择，改为默认增加业务员"),this.businessModel.authType=A["b"].Auth),this.changeQrContent()}},{key:"changeInputAddress",value:function(){this.changeQrContent()}},{key:"changeInputName",value:function(){this.changeQrContent()}},{key:"changeQrContent",value:function(){var e=this;null!==this.lastFn&&clearTimeout(this.lastFn),this.lastFn=setTimeout((function(){e.lastFn=null,e.assembleQrInfo()}),y["a"].FORM_QR_INTERVAL)}},{key:"assembleQrInfo",value:function(){var e=this;if(this.inputName&&this.inputAddress&&0!==this.countTime){if(!Object(x["b"])(this.inputAddress))return w["a"].fail("输入的地址格式有问题，请重新检查"),console.log("this.inputAddress.toString().length===>"+this.inputAddress.toString().length),"";this.isLoadingAccount=!0,this.loadWaitSignInfo().then((function(t){t&&0!==t.toString().length?(e.signText="https://cashbox.scry.info/qr?ct=66&ot=ds&dt=0&dtt="+y["a"].QR_PARAM_BUSINESS+"&v="+t+"&tl="+y["a"].QR_USEFUL_TIME()+"&",console.log("this.signText:"+e.signText),e.showQr=!0,e.showScanQrBtn=!0):(e.showQr=!1,w["a"].fail("生成授权二维码数据失败，请重新打开应用尝试")),e.isLoadingAccount=!1})).catch((function(t){e.isLoadingAccount=!1,e.showQr=!1,console.log("e===>"+t.toString()),w["a"].fail("生成授权二维码出现错误"+t.toString())}))}else this.isLoadingAccount=!1,this.showQr=!1,w["a"].fail("请检查数据不能为空")}},{key:"loadWaitSignInfo",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.radioAuthBtnValue!==this.AddBusiness){e.next=6;break}return e.next=3,C["b"].getInstance().assembleAddBusinessInfo(this.$store.state.nativeChainAddress,this.inputName,this.inputAddress,this.countTime);case 3:this.waitSignInfo=e.sent,e.next=9;break;case 6:return e.next=8,C["b"].getInstance().assembleDeleteBusinessInfo(this.$store.state.nativeChainAddress,this.inputAddress);case 8:this.waitSignInfo=e.sent;case 9:return e.abrupt("return",this.waitSignInfo);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"scanOrChooseAddress",value:function(){this.radioAuthBtnValue===this.AddBusiness?S["a"].getInstance().callNativeQrScanToJs():this.isShowAddressPopup=!0}},{key:"confirmPickerAddress",value:function(e){if(this.isShowAddressPopup=!1,e){var t=e.indexOf(this.SeparateSymbol);this.inputName=e.substring(0,t),this.inputAddress=e.substring(t+1,e.length)}}},{key:"scanToSignedQr",value:function(){S["a"].getInstance().callNativeQrScanToJs()}},{key:"nativeQrScanToJsResult",value:function(e){var t="";if(-1===e.indexOf(";"))return this.inputAddress=e,void w["a"].show("二维码信息符合地址格式，已录入地址!");for(var s=e.split(";"),i={},n=0;n<s.length;n++){var a=n,r=s[a].indexOf("=");-1!==r&&(i[s[a].substring(0,r)]=s[a].substring(r+1))}i.dtt&&i.dtt===y["a"].QR_PARAM_BUSINESS&&i.v?(t=i.v,i.addr&&(this.authAddress=i.addr),console.log("nativeQrScanToJsResult is ===>"+t+" || "+i.dtt+"||"+i.addr),w["a"].show("解析二维码成功!"),this.signedValue=t,this.isForbidChangeUsername=!0,this.isForbidChangeAuthCount=!0,this.isForbidChangeAddress=!0,this.isShowNextStepBtn=!0,this.showScanQrBtn=!1):w["a"].show("二维码格式有问题,不符合 授权业务员 签名格式")}},{key:"clickNextStep",value:function(){this.businessModel.authAddress=this.authAddress,this.businessModel.maxCount=this.countTime,this.businessModel.name=this.inputName,this.businessModel.address=this.inputAddress,this.businessModel.signInfo=this.signedValue,this.businessModel.authState=A["a"].SUCCESS,this.$store.commit("updateNowBusiness",this.businessModel),this.$router.push({name:"business_confirm"})}}]),t}(h["d"]);Object(l["a"])([Object(h["e"])("radioAuthBtnValue",{immediate:!0,deep:!0})],k.prototype,"onChangeAuthType",null),Object(l["a"])([Object(h["e"])("inputAddress",{immediate:!0,deep:!0})],k.prototype,"changeInputAddress",null),Object(l["a"])([Object(h["e"])("inputName",{immediate:!0,deep:!0})],k.prototype,"changeInputName",null),k=Object(l["a"])([Object(h["a"])({components:{ScanSign:_["a"]}})],k);var O=k,B=O,N=(s("f852"),s("2877")),I=Object(N["a"])(B,i,n,!1,null,null,null);t["default"]=I.exports},"7a75":function(e,t,s){},"857f":function(e,t,s){},9884:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return r}));var i=s("2b0e");function n(e){var t=[];function s(e){e.forEach((function(e){t.push(e),e.children&&s(e.children)}))}return s(e),t}function a(e,t){var s,a;void 0===t&&(t={});var r=t.indexKey||"index";return i["a"].extend({inject:(s={},s[e]={default:null},s),computed:(a={parent:function(){return this.disableBindRelation?null:this[e]}},a[r]=function(){return this.bindRelation(),this.parent.children.indexOf(this)},a),mounted:function(){this.bindRelation()},beforeDestroy:function(){var e=this;this.parent&&(this.parent.children=this.parent.children.filter((function(t){return t!==e})))},methods:{bindRelation:function(){if(this.parent&&-1===this.parent.children.indexOf(this)){var e=[].concat(this.parent.children,[this]),t=n(this.parent.slots());e.sort((function(e,s){return t.indexOf(e.$vnode)-t.indexOf(s.$vnode)})),this.parent.children=e}}}})}function r(e){return{provide:function(){var t;return t={},t[e]=this,t},data:function(){return{children:[]}}}}},"9f14":function(e,t,s){"use strict";var i=s("d282"),n=s("ad06"),a=s("9884"),r=s("ea8e"),o=function(e){var t=e.parent,s=e.bem,i=e.role;return{mixins:[Object(a["a"])(t)],props:{name:null,value:null,disabled:Boolean,iconSize:[Number,String],checkedColor:String,labelPosition:String,labelDisabled:Boolean,shape:{type:String,default:"round"},bindGroup:{type:Boolean,default:!0}},computed:{disableBindRelation:function(){return!this.bindGroup},isDisabled:function(){return this.parent&&this.parent.disabled||this.disabled},iconStyle:function(){var e=this.checkedColor||this.parent&&this.parent.checkedColor;if(e&&this.checked&&!this.isDisabled)return{borderColor:e,backgroundColor:e}},tabindex:function(){return this.isDisabled||"radio"===i&&!this.checked?-1:0}},methods:{onClick:function(e){var t=this.$refs.label,s=e.target,i=t&&(t===s||t.contains(s));this.isDisabled||i&&this.labelDisabled||this.toggle(),this.$emit("click",e)}},render:function(){var e=arguments[0],t=this.slots,a=this.checked,o=t("icon",{checked:a})||e(n["a"],{attrs:{name:"success"},style:this.iconStyle}),u=t()&&e("span",{ref:"label",class:s("label",[this.labelPosition,{disabled:this.isDisabled}])},[t()]),d=this.iconSize||this.parent&&this.parent.iconSize,c=[e("div",{class:s("icon",[this.shape,{disabled:this.isDisabled,checked:a}]),style:{fontSize:Object(r["a"])(d)}},[o])];return"left"===this.labelPosition?c.unshift(u):c.push(u),e("div",{attrs:{role:i,tabindex:this.tabindex,"aria-checked":String(this.checked)},class:s(),on:{click:this.onClick}},[c])}}},u=Object(i["a"])("radio"),d=u[0],c=u[1];t["a"]=d({mixins:[o({bem:c,role:"radio",parent:"vanRadio"})],computed:{currentValue:{get:function(){return this.parent?this.parent.value:this.value},set:function(e){(this.parent||this).$emit("input",e)}},checked:function(){return this.currentValue===this.name}},methods:{toggle:function(){this.currentValue=this.name}}})},b657:function(e,t,s){s("a29f")},e27c:function(e,t,s){"use strict";var i=s("d282"),n=s("9884"),a=Object(i["a"])("radio-group"),r=a[0],o=a[1];t["a"]=r({mixins:[Object(n["b"])("vanRadio")],props:{value:null,disabled:Boolean,checkedColor:String,iconSize:[Number,String]},watch:{value:function(e){this.$emit("change",e)}},render:function(){var e=arguments[0];return e("div",{class:o(),attrs:{role:"radiogroup"}},[this.slots()])}})},e815:function(e,t,s){s("a29f")},f852:function(e,t,s){"use strict";var i=s("7a75"),n=s.n(i);n.a}}]);
//# sourceMappingURL=chunk-33e699b9.d5a7dd5d.js.map